<script>
  var barChart;

  function getOrderChart() {
      fetch('api/order_api/filters/')
          .then(response => response.json())
          .then(data => {
              // Accessing the bar chart data
              var barChartData = {
                  labels: data.bar_chart_data.labels,
                  values: data.bar_chart_data.values
              };
  
              // Check if the chart is already initialized
              if (barChart) {
                  // Update the existing chart with new data
                  barChart.data.labels = barChartData.labels;
                  barChart.data.datasets[0].data = barChartData.values;
                  barChart.update();
              } else {
                  // Initialize the chart if it doesn't exist
                  var barChartCanvas = document.getElementById('order-status-chart-canvas').getContext('2d');
                  barChart = new Chart(barChartCanvas, {
                      type: 'bar',
                      data: {
                          labels: barChartData.labels,
                          datasets: [{
                              label: 'عدد الطلبات',
                              data: barChartData.values,
                              minBarLength: 10,
                              backgroundColor: ['#3498db', '#2ecc71', '#e74c3c', '#f39c12', '#9b59b6', '#34495e', '#1abc9c', '#e67e22', '#7f8c8d', '#d35400'],  // Customize the colors as needed
                          }]
                      },
                      options: {
                          responsive: true,
                          maintainAspectRatio: false,
                          onClick: function (e, items) {
                              if (items.length > 0) {
                                  // Bar is clicked
                                  var clickedIndex = items[0].index;
                                  var clickedStatus = barChartData.labels[clickedIndex];
  
                                  // Perform an action, e.g., filter data table by status
                                  filterDataTableByStatus(clickedStatus);
                              }
                          }
                          // Add additional chart options as needed
                          
                      },
                      
                  });
              }
          })
          .catch(error => console.error('Error fetching data:', error));
  }
  
    function filterDataTableByStatus(status) {
      initDatatable('api/order_api/Hisham/datatable_list?status=' + status);
      console.log(status);
    }
  
</script>